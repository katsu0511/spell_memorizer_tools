-- 旧テーブル削除
DROP TABLE IF EXISTS USER;
DROP TABLE IF EXISTS BKTB;
DROP TABLE IF EXISTS CPTB;
DROP TABLE IF EXISTS WDTB;
DROP TABLE IF EXISTS MARK;


-- USERテーブル
CREATE TABLE USER(
	USERID int AUTO_INCREMENT COMMENT "ユーザーID",
	EMLADR varchar(100) NOT NULL UNIQUE COMMENT "メールアドレス",
	PASSWD varchar(100) NOT NULL COMMENT "パスワード",
	ETDTTM timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT "入力日時",
	PRIMARY KEY (USERID)
);


-- BKTBテーブル
CREATE TABLE BKTB(
    BOOKCD varchar(10) COMMENT "単語帳コード",
    BOOKNM varchar(100) NOT NULL UNIQUE COMMENT "単語帳名",
    ETDTTM timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT "入力日時",
    PRIMARY KEY (BOOKCD)
);

INSERT INTO BKTB (BOOKCD, BOOKNM) VALUES ("0000000001", "実践IELTS 英単語3500");


-- CPTBテーブル
CREATE TABLE CPTB(
    CPTRCD varchar(10) COMMENT "チャプターコード",
    BOOKCD varchar(10) NOT NULL COMMENT "単語帳コード",
    CPTRNM varchar(100) NOT NULL COMMENT "チャプター名",
    ETDTTM timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT "入力日時",
    PRIMARY KEY (CPTRCD),
    FOREIGN KEY (BOOKCD) REFERENCES BKTB(BOOKCD) ON DELETE CASCADE ON UPDATE CASCADE
);

INSERT INTO CPTB (CPTRCD, BOOKCD, CPTRNM) VALUES ("0000000001", "0000000001", "基礎語1000");
INSERT INTO CPTB (CPTRCD, BOOKCD, CPTRNM) VALUES ("0000000002", "0000000001", "重要語2500 レベル1");
INSERT INTO CPTB (CPTRCD, BOOKCD, CPTRNM) VALUES ("0000000003", "0000000001", "重要語2500 レベル2");
INSERT INTO CPTB (CPTRCD, BOOKCD, CPTRNM) VALUES ("0000000004", "0000000001", "重要語2500 レベル3");
INSERT INTO CPTB (CPTRCD, BOOKCD, CPTRNM) VALUES ("0000000005", "0000000001", "重要語2500 レベル4");
INSERT INTO CPTB (CPTRCD, BOOKCD, CPTRNM) VALUES ("0000000006", "0000000001", "重要語2500 レベル5");


-- WDTBテーブル
CREATE TABLE WDTB(
    WORDCD varchar(10) COMMENT "単語コード",
    CPTRCD varchar(10) NOT NULL COMMENT "チャプターコード",
    WORDNU int NOT NULL COMMENT "単語番号",
    WRDSPL varchar(100) NOT NULL COMMENT "単語スペル",
    WRDSND varchar(100) NOT NULL COMMENT "単語発音",
    ETDTTM timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT "入力日時",
    PRIMARY KEY (WORDCD),
    FOREIGN KEY (CPTRCD) REFERENCES CPTB(CPTRCD) ON DELETE CASCADE ON UPDATE CASCADE
);

INSERT INTO WDTB (WORDCD,CPTRCD,WORDNU,WRDSPL,WRDSND) VALUES ("0000000010","0000000001",10,"","0000000010.mp3");
INSERT INTO WDTB (WORDCD,CPTRCD,WORDNU,WRDSPL,WRDSND) VALUES ("0000000100","0000000001",100,"","0000000100.mp3");


-- MARKテーブル
CREATE TABLE MARK(
	MARKID int AUTO_INCREMENT COMMENT "マークID",
	USERID int NOT NULL COMMENT "ユーザーID",
	WORDCD varchar(10) NOT NULL COMMENT "単語コード",
	CRRCTD boolean NOT NULL COMMENT "正解",
	ETDTTM timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT "入力日時",
	PRIMARY KEY (MARKID),
    FOREIGN KEY (USERID) REFERENCES USER(USERID) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (WORDCD) REFERENCES WDTB(WORDCD) ON DELETE CASCADE ON UPDATE CASCADE
);
